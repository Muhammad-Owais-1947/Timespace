<!DOCTYPE html>
<!-- 'scroll-smooth' enables smooth scrolling for anchor links -->
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!--  SEO: Title Tag -->
    <title>Time Space | AI Data Organizer</title>

    <!--  favicon -->
    <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke-width='1.5' stroke='%233b82f6'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 00.75-.75 2.25 2.25 0 00-.1-.664m-5.8 0A2.251 2.251 0 0113.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C6.095 4.01 5.25 4.973 5.25 6.108V18.75c0 1.243.87 2.25 1.976 2.25h4.272a2.25 2.25 0 002.25-2.25V5.117A2.25 2.25 0 0011.25 3H9.75a2.25 2.25 0 00-2.25 2.25z' /%3E%3C/svg%3E">
    
    <!-- SEO: Meta Tags -->
    <meta name="description" content="Instantly analyze and organize any data. Upload a PDF, image, CSV, or Excel file of your notes, schedule, or list, and our AI will create a beautiful, interactive display for you.">
    <meta name="keywords" content="data organizer, schedule maker, list maker, AI organizer, timetable generator, upload data, data analysis tool">

    <!-- SEO: Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://example.com/"> <!-- âœï¸ EDIT: Change this to your live URL -->
    <meta property="og:title" content="Time Space | AI Data Organizer">
    <meta property="og:description" content="Instantly analyze and organize any data. Upload a PDF, image, CSV, or Excel file of your notes, schedule, or list, and our AI will create a beautiful, interactive display for you.">
    <meta property="og:image" content="https://placehold.co/1200x630/3b82f6/ffffff?text=Time+Space"> <!-- âœï¸ EDIT: Change to a link of a preview image -->
    
    <!-- SEO: Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://example.com/"> <!-- âœï¸ EDIT: Change this to your live URL -->
    <meta property="twitter:title" content="Time Space | AI Data Organizer">
    <meta property="twitter:description" content="Instantly analyze and organize any data. Upload a PDF, image, CSV, or Excel file of your notes, schedule, or list, and our AI will create a beautiful, interactive display for you.">
    <meta property="twitter:image" content="https://placehold.co/1200x630/3b82f6/ffffff?text=Time+Space"> <!-- âœï¸ EDIT: Change to a link of a preview image -->

    <!-- External Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = { darkMode: 'class', theme: { extend: { fontFamily: { sans: ['Inter', 'sans-serif'] } } } }
    </script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://unpkg.com/papaparse@latest/papaparse.min.js"></script>
    <script src="https://cdn.sheetjs.com/xlsx-0.20.3/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>

    <!-- Main Stylesheet -->
    <style>
        body { font-family: 'Inter', sans-serif; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; }
        .day-section.day-mon { background-color: #dcfce7; } .dark .day-section.day-mon { background-color: #164e32; }
        .day-section.day-tue { background-color: #dbeafe; } .dark .day-section.day-tue { background-color: #1e3a8a; }
        .day-section.day-wed { background-color: #fee2e2; } .dark .day-section.day-wed { background-color: #7f1d1d; }
        .day-section.day-thu { background-color: #cffafe; } .dark .day-section.day-thu { background-color: #164e63; }
        .day-section.day-fri { background-color: #ede9fe; } .dark .day-section.day-fri { background-color: #4c1d95; }
        .day-section.day-sat { background-color: #ffedd5; } .dark .day-section.day-sat { background-color: #7c2d12; }
        .day-section.day-sun { background-color: #fce7f3; } .dark .day-section.day-sun { background-color: #831843; }
        #data-table tr.day-mon { background-color: #f0fdf4; border-left: 3px solid #4ade80; } .dark #data-table tr.day-mon { background-color: #164e3233; }
        #data-table tr.day-tue { background-color: #eff6ff; border-left: 3px solid #60a5fa; } .dark #data-table tr.day-tue { background-color: #1e3a8a33; }
        #data-table tr.day-wed { background-color: #fef2f2; border-left: 3px solid #f87171; } .dark #data-table tr.day-wed { background-color: #7f1d1d33; }
        #data-table tr.day-thu { background-color: #ecfeff; border-left: 3px solid #22d3ee; } .dark #data-table tr.day-thu { background-color: #164e6333; }
        #data-table tr.day-fri { background-color: #faf5ff; border-left: 3px solid #a78bfa; } .dark #data-table tr.day-fri { background-color: #4c1d9533; }
        #data-table tr.day-sat { background-color: #fff7ed; border-left: 3px solid #fb923c; } .dark #data-table tr.day-sat { background-color: #7c2d1233; }
        #data-table tr.day-sun { background-color: #fdf4ff; border-left: 3px solid #f472b6; } .dark #data-table tr.day-sun { background-color: #83184333; }
        .class-card { background-color: #ffffff; border: 1px solid #e5e7eb; transition: transform 0.2s ease, box-shadow 0.2s ease; cursor: grab; }
        .dark .class-card { background-color: #1f2937; border-color: #374151; }
        .class-card:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08); }
        .dark .class-card:hover { box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15); }
        .sortable-chosen { opacity: 0.7; transform: scale(1.02); }
        .fade-in { animation: fadeIn 0.5s ease-in-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        #data-table { width: 100%; border-collapse: collapse; }
        #data-table th, #data-table td { padding: 1rem 1.25rem; text-align: left; border-bottom: 1px solid #e5e7eb; }
        .dark #data-table th, .dark #data-table td { border-bottom-color: #374151; }
        #data-table th { background-color: #f9fafb; font-weight: 600; font-size: 0.75rem; text-transform: uppercase; letter-spacing: 0.05em; color: #4b5563; }
        .dark #data-table th { background-color: #1f2937; color: #9ca3af; }
        #data-table tbody tr { transition: background-color 0.2s ease-in-out, transform 0.2s ease-in-out; }
        #data-table tbody tr:hover { transform: translateY(-2px); background-color: #f3f4f6; }
        .dark #data-table tbody tr:hover { background-color: #374151; }
        .class-card input { background-color: transparent; border: 0; border-bottom: 1px dashed #9ca3af; padding: 2px 0; width: 100%; transition: border-color 0.2s; }
        .class-card input:focus { outline: none; border-bottom: 1px solid #3b82f6; }
        .btn-animate { transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out, background-color 0.2s ease-in-out, filter 0.2s ease-in-out; }
        .btn-animate:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        .dark .btn-animate:hover { box-shadow: 0 4px 14px rgba(0,0,0,0.25); }
        #report-issue-button { position: fixed; bottom: 2rem; right: 2rem; z-index: 1000; background-color: #ef4444; color: white; width: 3.5rem; height: 3.5rem; border-radius: 9999px; display: flex; align-items: center; justify-content: center; box-shadow: 0 0 0 0 rgba(239, 68, 68, 1); animation: glow-red 2s infinite; }
        .dark #report-issue-button { background-color: #f87171; }
        @keyframes glow-red { 0% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7); } 70% { box-shadow: 0 0 0 15px rgba(239, 68, 68, 0); } 100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0); } }
        .loader-overlay { position: fixed; inset: 0; z-index: 9999; display: flex; flex-direction: column; align-items: center; justify-content: center; background-color: rgba(248, 250, 252, 0.8); backdrop-filter: blur(4px); transition: opacity 0.5s ease-in-out; }
        .dark .loader-overlay { background-color: rgba(15, 23, 42, 0.8); }
        .loader-overlay.hidden { opacity: 0; pointer-events: none; }
        .loader-logo path { stroke-dasharray: 250; stroke-dashoffset: 250; animation: draw 2s ease-in-out infinite; }
        .loader-text { animation: pulse-text 2s ease-in-out infinite; }
        @keyframes draw { 0% { stroke-dashoffset: 250; } 50% { stroke-dashoffset: 0; } 100% { stroke-dashoffset: -250; } }
        @keyframes pulse-text { 0% { opacity: 0.5; } 50% { opacity: 1; } 100% { opacity: 0.5; } }
        #calendar-container { display: grid; grid-template-columns: repeat(7, minmax(0, 1fr)); gap: 1px; background-color: #e5e7eb; border: 1px solid #e5e7eb; border-radius: 0.5rem; overflow: hidden; }
        .dark #calendar-container { background-color: #374151; border-color: #374151; }
        .calendar-header { text-align: center; font-weight: 600; padding: 0.5rem 0; background-color: #f9fafb; font-size: 0.875rem; }
        .dark .calendar-header { background-color: #1f2937; }
        .calendar-day { background-color: #ffffff; padding: 0.5rem; min-height: 100px; }
        .dark .calendar-day { background-color: #111827; }
        .calendar-day.other-month { background-color: #f3f4f6; }
        .dark .calendar-day.other-month { background-color: #1f2937; }
        .calendar-day-number { font-weight: 500; }
        .calendar-item { font-size: 0.75rem; padding: 0.25rem; margin-top: 0.25rem; border-radius: 0.25rem; background-color: #dbeafe; color: #1e40af; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
        .dark .calendar-item { background-color: #1e3a8a; color: #bfdbfe; }
    </style>
</head>

<body class="bg-slate-50 dark:bg-slate-900 text-slate-800 dark:text-slate-200">

<!-- Initial Page Loader -->
<div id="page-loader" class="loader-overlay">
    <svg class="loader-logo h-16 w-16 text-blue-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 00.75-.75 2.25 2.25 0 00-.1-.664m-5.8 0A2.251 2.251 0 0113.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C6.095 4.01 5.25 4.973 5.25 6.108V18.75c0 1.243.87 2.25 1.976 2.25h4.272a2.25 2.25 0 002.25-2.25V5.117A2.25 2.25 0 0011.25 3H9.75a2.25 2.25 0 00-2.25 2.25z" /></svg>
    <p class="loader-text text-blue-600 dark:text-blue-400 font-medium mt-4 text-lg" data-translate-key="loading_analyzer">Loading Time Space...</p>
</div>

<!-- File Processing Loader -->
<div id="processing-loader" class="loader-overlay hidden">
     <svg class="loader-logo h-16 w-16 text-blue-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 00.75-.75 2.25 2.25 0 00-.1-.664m-5.8 0A2.251 2.251 0 0113.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C6.095 4.01 5.25 4.973 5.25 6.108V18.75c0 1.243.87 2.25 1.976 2.25h4.272a2.25 2.25 0 002.25-2.25V5.117A2.25 2.25 0 0011.25 3H9.75a2.25 2.25 0 00-2.25 2.25z" /></svg>
    <p class="loader-text text-blue-600 dark:text-blue-400 font-medium mt-4 text-lg" data-translate-key="analyzing">Making magic behind the scenes...</p>
</div>

<!-- Header -->
<header class="sticky top-0 z-50 w-full bg-white/80 dark:bg-slate-900/80 backdrop-blur-sm border-b border-slate-200 dark:border-slate-800 transition-transform duration-300">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex items-center justify-between h-16">
            <a href="#" class="flex items-center space-x-2">
                <svg class="h-8 w-8 text-blue-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" role="img" aria-label="Timetable Icon"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 00.75-.75 2.25 2.25 0 00-.1-.664m-5.8 0A2.251 2.251 0 0113.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C6.095 4.01 5.25 4.973 5.25 6.108V18.75c0 1.243.87 2.25 1.976 2.25h4.272a2.25 2.25 0 002.25-2.25V5.117A2.25 2.25 0 0011.25 3H9.75a2.25 2.25 0 00-2.25 2.25z" /></svg>
                <span class="font-bold text-lg sm:text-xl text-slate-900 dark:text-white" data-translate-key="site_name">Time Space</span>
            </a>
            <div class="flex items-center space-x-2 sm:space-x-4">
                <nav class="hidden md:flex items-center space-x-4 text-sm font-medium text-slate-600 dark:text-slate-400">
                    <a href="#features" class="hover:text-blue-600 transition-colors" data-translate-key="nav_features">Features</a>
                    <a href="#portfolio" class="hover:text-blue-600 transition-colors" data-translate-key="nav_portfolio">Portfolio</a>
                </nav>
                <div class="h-6 w-px bg-slate-200 dark:bg-slate-700 hidden md:block"></div>
                <button id="lang-toggle" class="h-9 w-9 flex items-center justify-center rounded-lg text-slate-500 hover:bg-slate-200 dark:text-slate-400 dark:hover:bg-slate-800 transition-colors btn-animate font-semibold text-xs"></button>
                <button id="theme-toggle" class="h-9 w-9 flex items-center justify-center rounded-lg text-slate-500 hover:bg-slate-200 dark:text-slate-400 dark:hover:bg-slate-800 transition-colors btn-animate">
                    <svg class="h-5 w-5 block dark:hidden" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" role="img" aria-label="Moon Icon"><path stroke-linecap="round" stroke-linejoin="round" d="M21.752 15.002A9.718 9.718 0 0118 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 003 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 009.002-5.998z" /></svg>
                    <svg class="h-5 w-5 hidden dark:block" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" role="img" aria-label="Sun Icon"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386l-1.591 1.591M21 12h-2.25m-.386 6.364l-1.591-1.591M12 18.75V21m-4.773-4.227l-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z" /></svg>
                </button>
            </div>
        </div>
    </div>
</header>

<main>
    <section class="text-center py-16 sm:py-24 px-4 sm:px-6 lg:px-8">
        <h1 class="text-4xl sm:text-5xl lg:text-6xl font-bold tracking-tight text-slate-900 dark:text-white" data-translate-key="hero_title">Intelligent Data Organizer</h1>
        <p class="mt-4 max-w-2xl mx-auto text-lg text-slate-600 dark:text-slate-400" data-translate-key="hero_subtitle">Automatically analyze, structure, and visualize your data. Just upload any file to begin.</p>
        <div id="data-app" class="max-w-4xl mx-auto mt-12 bg-white dark:bg-slate-800 rounded-2xl shadow-lg overflow-hidden border border-slate-200 dark:border-slate-700 text-left">
            <div id="upload-section" class="p-4 sm:p-6 border-b border-slate-200 dark:border-slate-700 flex flex-col items-center">
                 <button id="upload-button" class="btn-animate w-full max-w-xs px-6 py-3 text-base font-semibold bg-blue-600 text-white rounded-lg shadow-md hover:bg-blue-700 dark:hover:bg-blue-500" data-translate-key="upload_button">Upload Your Data File</button>
                <input type="file" id="file-upload" accept="image/*,application/pdf,.csv,.xlsx" class="hidden"/>
                <p class="text-xs text-slate-500 dark:text-slate-400 mt-2" data-translate-key="upload_caption">Max file size: 10MB. Supports PDF, PNG, JPG, CSV, XLSX.</p>
                <div id="status-message" class="mt-4 p-3 rounded-md text-sm text-center hidden w-full" role="alert"></div>
            </div>
            <div id="controls-area" class="hidden">
                 <div class="p-4 sm:p-6 border-b border-slate-200 dark:border-slate-700">
                    <div class="flex flex-col sm:flex-row items-center justify-between gap-4">
                         <label class="text-base font-semibold text-slate-800 dark:text-slate-200 whitespace-nowrap" data-translate-key="controls_title">âœ¨ AI Analysis Complete â€” Hereâ€™s Your Interactive Data!</label>
                        <div class="flex items-center gap-2">
                             <div id="view-buttons" class="flex-shrink-0 flex items-center space-x-2 bg-slate-100 dark:bg-slate-900 p-1 rounded-md">
                                <button id="view-card" class="px-3 py-1.5 text-sm font-medium rounded-md transition-colors btn-animate" data-translate-key="card_view">Card View</button>
                                <button id="view-table" class="px-3 py-1.5 text-sm font-medium rounded-md transition-colors btn-animate" data-translate-key="table_view">Table View</button>
                                <button id="view-list" class="hidden px-3 py-1.5 text-sm font-medium rounded-md transition-colors btn-animate" data-translate-key="list_view">List View</button>
                                <button id="view-calendar" class="hidden px-3 py-1.5 text-sm font-medium rounded-md transition-colors btn-animate" data-translate-key="calendar_view">Calendar View</button>
                            </div>
                            <button id="clear-data" class="px-3 py-1.5 text-sm font-medium rounded-md transition-colors btn-animate bg-red-100 text-red-700 hover:bg-red-200 dark:bg-red-900/50" data-translate-key="clear_button">Clear</button>
                        </div>
                    </div>
                </div>
            </div>
            <div id="results-area" class="bg-slate-50 dark:bg-slate-900/50 p-4 sm:p-6">
                <div id="data-container" class="space-y-6 hidden"></div>
                <div id="calendar-container" class="hidden"></div>
                <div class="overflow-x-auto rounded-lg border border-slate-200 dark:border-slate-700">
                    <table id="data-table" class="hidden">
                        <thead></thead>
                        <tbody></tbody>
                    </table>
                </div>
                 <div id="download-options" class="mt-6 flex flex-wrap gap-3 hidden">
                    <button id="download-pdf" class="btn-animate px-4 py-2 text-sm font-medium bg-blue-600 text-white rounded-md shadow-sm" data-translate-key="download_pdf">Download PDF</button>
                    <button id="download-png" class="btn-animate px-4 py-2 text-sm font-medium bg-emerald-600 text-white rounded-md shadow-sm" data-translate-key="download_png">Download PNG</button>
                    <button id="download-csv" class="btn-animate px-4 py-2 text-sm font-medium bg-slate-600 text-white rounded-md shadow-sm" data-translate-key="download_csv">Download CSV</button>
                    <button id="download-xlsx" class="btn-animate px-4 py-2 text-sm font-medium bg-slate-600 text-white rounded-md shadow-sm" data-translate-key="download_xlsx">Download XLSX</button>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Features Section -->
    <section id="features" class="py-16 sm:py-24 bg-white dark:bg-slate-800">
        <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center">
                <h2 class="text-3xl font-bold tracking-tight text-slate-900 dark:text-white sm:text-4xl" data-translate-key="features_title">Powerful Features, Simple Interface</h2>
                <p class="mt-4 text-lg text-slate-600 dark:text-slate-400" data-translate-key="features_subtitle">Everything you need to manage your data efficiently.</p>
            </div>
            <div class="mt-12 grid gap-8 sm:grid-cols-2 lg:grid-cols-3">
                <div class="flex items-start space-x-4">
                    <div class="flex-shrink-0 h-12 w-12 flex items-center justify-center bg-blue-100 dark:bg-blue-900/50 rounded-lg text-blue-600 dark:text-blue-400">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6" role="img" aria-label="Cloud Upload Icon"><path stroke-linecap="round" stroke-linejoin="round" d="M12 16.5V9.75m0 0l-3 3m3-3l3 3M6.75 19.5a4.5 4.5 0 01-1.41-8.775 5.25 5.25 0 0110.233-2.33 3 3 0 013.758 3.848A3.752 3.752 0 0118 19.5H6.75z" /></svg>
                    </div>
                    <div>
                        <h3 class="text-lg font-semibold text-slate-900 dark:text-white" data-translate-key="feature1_title">Smart Data Extraction</h3>
                        <p class="mt-1 text-slate-600 dark:text-slate-400" data-translate-key="feature1_desc">Intelligently analyzes any data structure from images, PDFs, CSV, and Excel files.</p>
                    </div>
                </div>
                <div class="flex items-start space-x-4">
                    <div class="flex-shrink-0 h-12 w-12 flex items-center justify-center bg-blue-100 dark:bg-blue-900/50 rounded-lg text-blue-600 dark:text-blue-400">
                         <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6" role="img" aria-label="Layout Icon"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6A2.25 2.25 0 016 3.75h2.25A2.25 2.25 0 0110.5 6v2.25a2.25 2.25 0 01-2.25 2.25H6a2.25 2.25 0 01-2.25-2.25V6zM3.75 15.75A2.25 2.25 0 016 13.5h2.25a2.25 2.25 0 012.25 2.25V18a2.25 2.25 0 01-2.25 2.25H6a2.25 2.25 0 01-2.25-2.25v-2.25zM13.5 6a2.25 2.25 0 012.25-2.25H18A2.25 2.25 0 0120.25 6v2.25A2.25 2.25 0 0118 10.5h-2.25A2.25 2.25 0 0113.5 8.25V6zM13.5 15.75a2.25 2.25 0 012.25-2.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-2.25A2.25 2.25 0 0113.5 18v-2.25z" /></svg>
                    </div>
                    <div>
                        <h3 class="text-lg font-semibold text-slate-900 dark:text-white" data-translate-key="feature2_title">Multiple View Options</h3>
                        <p class="mt-1 text-slate-600 dark:text-slate-400" data-translate-key="feature2_desc">View your information as a table, cards, a checklist, or even on a calendar if dates are found.</p>
                    </div>
                </div>
                <div class="flex items-start space-x-4">
                    <div class="flex-shrink-0 h-12 w-12 flex items-center justify-center bg-blue-100 dark:bg-blue-900/50 rounded-lg text-blue-600 dark:text-blue-400">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6" role="img" aria-label="Download Icon"><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3" /></svg>
                    </div>
                    <div>
                        <h3 class="text-lg font-semibold text-slate-900 dark:text-white" data-translate-key="feature3_title">Multiple Export Options</h3>
                        <p class="mt-1 text-slate-600 dark:text-slate-400" data-translate-key="feature3_desc">Download your organized data as a PDF, PNG, CSV, or XLSX file.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Portfolio Section -->
    <section id="portfolio" class="py-16 sm:py-24">
        <div class="max-w-3xl mx-auto text-center px-4 sm:px-6 lg:px-8">
            <h2 class="text-3xl font-bold tracking-tight text-slate-900 dark:text-white sm:text-4xl" data-translate-key="portfolio_title">Have a Look</h2>
            <p class="mt-4 text-lg text-slate-600 dark:text-slate-400" data-translate-key="portfolio_desc">Interested in seeing more of my work? Visit my portfolio to explore other projects.</p>
            <div class="mt-8">
                <!-- âœï¸ EDIT: Change the link to your portfolio -->
                <a href="https://muhammad-owias.github.io/portfolio/" target="_blank" rel="noopener noreferrer" class="btn-animate inline-block px-8 py-3 text-base font-semibold bg-blue-600 text-white rounded-lg shadow-md" data-translate-key="portfolio_button">
                    Check Out What Iâ€™ve Built
                </a>
            </div>
        </div>
    </section>
</main>

<!-- Footer -->
<footer class="bg-white dark:bg-slate-800 border-t border-slate-200 dark:border-slate-700">
    <div class="max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:px-8 text-center text-sm text-slate-500 dark:text-slate-400">
        <!-- âœï¸ EDIT: Change copyright year/text -->
        <p data-translate-key="footer_text">&copy; 2025 Time Space. All rights reserved. Crafted with Code & Coffee â˜• â€” Muhammad Owais.</p>
    </div>
</footer>

<!-- ðŸ“§ EDIT: Change your email address in the link below -->
<a id="report-issue-button" 
   href="https://mail.google.com/mail/?view=cm&fs=1&to=professional.OTS@Gmail.com&su=Issue%20Report:%20AI%20Data%20Organizer&body=Hello,%20I%20encountered%20an%20issue..." 
   target="_blank" rel="noopener noreferrer"
   class="btn-animate" 
   title="Report an Issue">
    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6" role="img" aria-label="Report Bug Icon"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z" /></svg>
</a>

<script>
    // ===================================================================================
    // JAVASCRIPT LOGIC
    // ===================================================================================

    // --- AUTO-HIDING HEADER ---
    const header = document.querySelector('header');
    let lastScrollTop = 0;
    window.addEventListener('scroll', () => {
        let scrollTop = window.pageYOffset || document.documentElement.scrollTop;
        header.classList.toggle('-translate-y-full', scrollTop > lastScrollTop && scrollTop > header.offsetHeight);
        lastScrollTop = scrollTop <= 0 ? 0 : scrollTop;
    });

    // --- THEME MANAGEMENT ---
    const themeToggle = document.getElementById('theme-toggle');
    if (localStorage.getItem('theme') === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
        document.documentElement.classList.add('dark');
    }
    themeToggle.addEventListener('click', () => {
        document.documentElement.classList.toggle('dark');
        localStorage.setItem('theme', document.documentElement.classList.contains('dark') ? 'dark' : 'light');
    });

    // --- LANGUAGE MANAGEMENT (CENTRALIZED TRANSLATIONS) ---
    // âœï¸ To add/edit text, modify this section.
    const langToggle = document.getElementById('lang-toggle');
    const translations = {
        en: {
            site_name: "Time Space", nav_features: "Features", nav_portfolio: "Portfolio", hero_title: "Intelligent Data Organizer", hero_subtitle: "Automatically analyze, structure, and visualize your data. Just upload any file to begin.", upload_button: "Upload Your Data File", upload_caption: "Max file size: 10MB. Supports PDF, PNG, JPG, CSV, XLSX.", controls_title: "âœ¨ AI Analysis Complete â€” Hereâ€™s Your Interactive Data!", card_view: "Card View", table_view: "Table View", list_view: "List View", calendar_view: "Calendar View", clear_button: "Clear", download_pdf: "Download PDF", download_png: "Download PNG", download_csv: "Download CSV", download_xlsx: "Download XLSX", features_title: "Powerful Features, Simple Interface", features_subtitle: "Everything you need to manage your data efficiently.", feature1_title: "Smart Data Extraction", feature1_desc: "Intelligently analyzes any data structure from images, PDFs, CSV, and Excel files.", feature2_title: "Multiple View Options", feature2_desc: "View your information as a table, cards, a checklist, or even on a calendar if dates are found.", feature3_title: "Multiple Export Options", feature3_desc: "Download your organized data as a PDF, PNG, CSV, or XLSX file.", portfolio_title: "Have a Look", portfolio_desc: "Interested in seeing more of my work? Visit my portfolio to explore other projects.", portfolio_button: "Check Out What Iâ€™ve Built", footer_text: "Â© 2025 Time Space. All rights reserved. Crafted with Code & Coffee â˜• â€” Muhammad Owais.", loading_analyzer: "Loading Time Space...", analyzing: "Making magic behind the scenes...", welcome_message: "Welcome to Time Space! The default timetable is loaded. Upload a file to see the magic.", default_loaded: "Default data loaded. Upload a file to see the magic.", schedule_cleared: "Data cleared. Showing default timetable.", file_uploaded: "File uploaded. Processing...", preparing_pdf: "Preparing PDF...", preparing_png: "Preparing PNG...", changes_saved: "Changes saved!", no_data: "No data to display.", unsupported_file_type: "Unsupported file type."
        },
        ur: {
            site_name: "Time Space", nav_features: "Khususiyat", nav_portfolio: "Portfolio", hero_title: "Aqalmand Data Organizer", hero_subtitle: "Apne data ko khud bakhud tajzia, tarteeb, aur visualize karein. Shuru karne ke liye bas koi file upload karein.", upload_button: "Apni Data File Upload Karein", upload_caption: "Max file size: 10MB. PDF, PNG, JPG, CSV, XLSX support hai.", controls_title: "âœ¨ AI Tajzia Mukammal â€” Aapka Interactive Data Hazir Hai!", card_view: "Card View", table_view: "Table View", list_view: "List View", calendar_view: "Calendar View", clear_button: "Saaf Karein", download_pdf: "PDF Download Karein", download_png: "PNG Download Karein", download_csv: "CSV Download Karein", download_xlsx: "XLSX Download Karein", features_title: "Zabardast Khususiyat, Asan Interface", features_subtitle: "Apne data ko muassar tareeqe se manage karne ke liye har cheez.", feature1_title: "Smart Data Nikalna", feature1_desc: "Tasaveer, PDFs, CSV, aur Excel files se kisi bhi data structure ka aqalmandana tajzia karta hai.", feature2_title: "Mukhtalif Views", feature2_desc: "Apni maloomat ko table, cards, checklist, ya calendar par dekhein agar tareekhein mojood hain.", feature3_title: "Kayi Export Options", feature3_desc: "Apna tarteeb shuda data PDF, PNG, CSV, ya XLSX file ke tor par download karein.", portfolio_title: "Mera Kaam Dekhein", portfolio_desc: "Mera mazeed kaam dekhne mein dilchaspi hai? Doosre projects ke liye mera portfolio visit karein.", portfolio_button: "Mera Kaam Dekhein", footer_text: "Â© 2025 Time Space. Tamam huqooq mehfooz hain. Code & Coffee se banaya â˜• â€” Muhammad Owais.", loading_analyzer: "Time Space Load ho raha hai...", analyzing: "Parde ke peeche jadu ho raha hai...", welcome_message: "Time Space mein khush amdeed! Default timetable load ho gaya hai. Jadu dekhne ke liye file upload karein.", default_loaded: "Default data load ho gaya. Jadu dekhne ke liye file upload karein.", schedule_cleared: "Data saaf ho gaya. Default timetable dikhaya ja raha hai.", file_uploaded: "File upload ho gayi. Processing ho rahi hai...", preparing_pdf: "PDF tayar ho raha hai...", preparing_png: "PNG tayar ho raha hai...", changes_saved: "Tabdiliyan mehfooz ho gayin!", no_data: "Dikhanay ke liye koi data nahi.", unsupported_file_type: "Na-qabil e qubool file type."
        }
    };
    let currentLang = 'en';
    function getText(key, lang = currentLang) { return translations[lang]?.[key] || key; }
    function setLanguage(lang) {
        currentLang = lang;
        document.documentElement.lang = lang;
        langToggle.textContent = lang === 'en' ? 'UR' : 'EN';
        document.querySelectorAll('[data-translate-key]').forEach(el => {
            const key = el.dataset.translateKey;
            el.textContent = getText(key);
        });
        localStorage.setItem('language', lang);
    }
    langToggle.addEventListener('click', () => setLanguage(currentLang === 'en' ? 'ur' : 'en'));
    
    // --- GLOBAL CONSTANTS AND STATE ---
    const GEMINI_API_KEY = "AIzaSyBX7j31bvSDIZx0p38FNZ0tfWAd3z0Esvs"; // âœï¸ IMPORTANT: Replace with your actual Gemini API Key
    const GEMINI_API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${GEMINI_API_KEY}`;
    const MAX_FILE_SIZE = 10 * 1024 * 1024;
    const DAY_CLASSES = {'Monday': 'day-mon', 'Mon': 'day-mon', 'Peer': 'day-mon', 'Tuesday': 'day-tue', 'Tue': 'day-tue', 'Mangal': 'day-tue', 'Wednesday': 'day-wed', 'Wed': 'day-wed', 'Budh': 'day-wed', 'Thursday': 'day-thu', 'Thu': 'day-thu', 'Jumerat': 'day-thu', 'Friday': 'day-fri', 'Fri': 'day-fri', 'Juma': 'day-fri', 'Saturday': 'day-sat', 'Sat': 'day-sat', 'Hafta': 'day-sat', 'Sunday': 'day-sun', 'Sun': 'day-sun', 'Itwar': 'day-sun'};
    const DAY_ORDER = ['Monday', 'Mon', 'Peer', 'Tuesday', 'Tue', 'Mangal', 'Wednesday', 'Wed', 'Budh', 'Thursday', 'Thu', 'Jumerat', 'Friday', 'Fri', 'Juma', 'Saturday', 'Sat', 'Hafta', 'Sunday', 'Sun', 'Itwar'];
    const defaultTimetableData = [
        { day: "Monday", time: "03:30 PM - 04:45 PM", code: "IS230", name: "Emerging Technologies", faculty: "Anusha Gilani", room: "SST-101" },
        { day: "Monday", time: "02:00 PM - 03:15 PM", code: "IS240", name: "Management Information System", faculty: "Anusha Gilani", room: "2N-02" },
        { day: "Tuesday", time: "05:00 PM - 06:15 PM", code: "FN340", name: "Business Finance", faculty: "Dr. M Mahmood Shah Khan", room: "2N-03" },
        { day: "Tuesday", time: "03:30 PM - 04:45 PM", code: "MK210", name: "Principles of Marketing", faculty: "Dr. Abdul Waheed", room: "1C-15" },
        { day: "Wednesday", time: "08:00 AM - 09:15 AM", code: "IS360", name: "Data Communication and Networking", faculty: "Abdul Ghafar", room: "2N-12" },
        { day: "Wednesday", time: "09:30 AM - 10:45 AM", code: "IS360", name: "Data Communication and Networking", faculty: "Abdul Ghafar", room: "2N-12" },
        { day: "Thursday", time: "03:30 PM - 04:45 PM", code: "IS230", name: "Emerging Technologies", faculty: "Anusha Gilani", room: "SST-101" },
        { day: "Thursday", time: "02:00 PM - 03:15 PM", code: "IS240", name: "Management Information System", faculty: "Anusha Gilani", room: "2N-02" },
        { day: "Friday", time: "11:00 AM - 12:15 PM", code: "IS412", name: "IT Project Management", faculty: "Sana Amjad", room: "2N-12" },
        { day: "Friday", time: "05:00 PM - 06:15 PM", code: "FN340", name: "Business Finance", faculty: "Dr. M Mahmood Shah Khan", room: "2N-03" },
        { day: "Friday", time: "03:30 PM - 04:45 PM", code: "MK210", name: "Principles of Marketing", faculty: "Dr. Abdul Waheed", room: "1C-15" },
        { day: "Friday", time: "02:00 PM - 03:15 PM", code: "IS412", name: "IT Project Management", faculty: "Sana Amjad", room: "2N-12" }
    ];
    let appData = JSON.parse(JSON.stringify(defaultTimetableData));
    let dataHeaders = []; let dayColumnKey = ''; let dateColumnKey = ''; let currentView = 'card'; let source = 'default';

    // --- DOM ELEMENT SELECTORS ---
    const pageLoader = document.getElementById('page-loader');
    const processingLoader = document.getElementById('processing-loader');
    const statusMessage = document.getElementById('status-message');
    const dataContainer = document.getElementById('data-container');
    const calendarContainer = document.getElementById('calendar-container');
    const dataTable = document.getElementById('data-table');
    const controlsArea = document.getElementById('controls-area');
    const downloadOptions = document.getElementById('download-options');
    const fileUpload = document.getElementById('file-upload');
    const uploadButton = document.getElementById('upload-button');
    const clearDataBtn = document.getElementById('clear-data');
    document.querySelectorAll('#view-buttons button').forEach(btn => btn.addEventListener('click', () => switchView(btn.id.replace('view-', ''))));

    // --- EVENT LISTENERS ---
    uploadButton.addEventListener('click', () => fileUpload.click());
    fileUpload.addEventListener('change', handleFileUpload);
    clearDataBtn.addEventListener('click', clearData);
    document.getElementById('download-pdf').addEventListener('click', () => downloadAsPDF());
    document.getElementById('download-png').addEventListener('click', () => downloadAsPNG());
    document.getElementById('download-csv').addEventListener('click', () => downloadAsCSV());
    document.getElementById('download-xlsx').addEventListener('click', () => downloadAsXLSX());

    // --- INITIALIZATION ---
    window.addEventListener('load', () => {
        const savedLang = localStorage.getItem('language') || 'en';
        setLanguage(savedLang);
        setTimeout(() => pageLoader.classList.add('hidden'), 250);
        prepareAndRender('card');
        showStatus('welcome_message', 'success');
    });

    // --- CORE FUNCTIONS ---
    function showStatus(messageKey, type) {
        statusMessage.textContent = getText(messageKey);
        statusMessage.className = `mt-4 p-3 rounded-md text-sm text-center w-full ${type === 'error' ? 'bg-red-100 dark:bg-red-900/50 text-red-700 dark:text-red-300' : 'bg-green-100 dark:bg-green-900/50 text-green-700 dark:text-green-300'}`;
        statusMessage.classList.remove('hidden');
    }
    function fileToBase64(file) { return new Promise((resolve, reject) => { const reader = new FileReader(); reader.onload = () => resolve(reader.result.split(',')[1]); reader.onerror = reject; reader.readAsDataURL(file); }); }
    function getDayIndex(day) { return DAY_ORDER.indexOf(day) === -1 ? Infinity : DAY_ORDER.indexOf(day); }
    function findDayColumnKey(headers) { const keywords = ['day', 'weekday', 'jour', 'din']; return headers.find(h => keywords.includes(h.toLowerCase())) || ''; }
    function findDateColumnKey(headers) { const keywords = ['date', 'deadline', 'day', 'tarikh']; return headers.find(h => keywords.some(k => h.toLowerCase().includes(k))) || ''; }

    function clearData() {
        appData = JSON.parse(JSON.stringify(defaultTimetableData));
        source = 'default';
        fileUpload.value = '';
        prepareAndRender('card');
        showStatus('schedule_cleared', 'success');
    }
    
    // --- FILE PROCESSING ---
    function structureParsedData(rawData) { if (rawData.length < 2) return []; const headers = rawData[0]; const dataRows = rawData.slice(1); return dataRows.map(row => { const entry = {}; headers.forEach((header, index) => { entry[header] = (row[index] || '').toString().trim(); }); return entry; }).filter(entry => Object.values(entry).some(val => val));}
    function parseCSV(file) { return new Promise((resolve, reject) => { Papa.parse(file, { complete: res => res.errors.length ? reject(res.errors[0]) : resolve(structureParsedData(res.data)), error: reject, skipEmptyLines: true }); }); }
    function parseXLSX(file) { return new Promise((resolve, reject) => { const reader = new FileReader(); reader.onload = e => { try { const workbook = XLSX.read(e.target.result, { type: 'binary' }); const worksheet = workbook.Sheets[workbook.SheetNames[0]]; resolve(structureParsedData(XLSX.utils.sheet_to_json(worksheet, { header: 1 }))); } catch (err) { reject(err); } }; reader.onerror = reject; reader.readAsBinaryString(file); }); }

    async function handleFileUpload(event) {
        const file = event.target.files[0];
        if (!file) return;
        if (file.size > MAX_FILE_SIZE) return showStatus('File too large! Max size is 10MB.', 'error');
        const allowedTypes = ['image/png', 'image/jpeg', 'application/pdf', 'text/csv', 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'];
        if (!allowedTypes.includes(file.type) && !file.name.endsWith('.csv')) return showStatus('unsupported_file_type', 'error');

        processingLoader.classList.remove('hidden');
        showStatus('file_uploaded', 'success');
        [dataContainer, dataTable.parentElement, calendarContainer].forEach(el => el.classList.add('hidden'));
        controlsArea.classList.add('hidden');
        downloadOptions.classList.add('hidden');

        try {
            const fileExt = file.name.split('.').pop().toLowerCase();
            if (fileExt === 'csv' || fileExt === 'xlsx') {
                const rawData = (fileExt === 'csv') ? await parseCSV(file) : await parseXLSX(file);
                await callSmartAI('application/json', JSON.stringify(rawData));
            } else {
                const fileData = await fileToBase64(file);
                await callSmartAI(file.type, fileData);
            }
        } catch (error) {
            console.error('Processing error:', error);
            showStatus(error.message, 'error');
            processingLoader.classList.add('hidden');
        }
    }

    async function callSmartAI(mimeType, dataForAI) {
        const isJson = mimeType === 'application/json';
        const systemPrompt = `Analyze this data. First, determine its most likely type (e.g., 'timetable', 'checklist', 'project-plan'). Second, identify if any column contains dates; if so, normalize them to 'YYYY-MM-DD' format. Third, extract all data into a JSON array. Finally, based on the content, suggest the best primary view ('table', 'card', 'list', 'calendar'). Your entire response MUST be a single JSON object with two keys: "viewSuggestion" and "data".`;
        const userParts = isJson ? [{ text: "Analyze this JSON data: " + dataForAI }] : [{ text: "Extract and analyze the data from this document." }, { inlineData: { mimeType, data: dataForAI } }];
        const payload = { contents: [{ parts: userParts }], systemInstruction: { parts: [{ text: systemPrompt }] }, generationConfig: { responseMimeType: "application/json" } };
        try {
            const response = await fetch(GEMINI_API_URL, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) });
            if (!response.ok) throw new Error(`API error: ${response.status}`);
            const result = await response.json();
            const jsonText = result.candidates?.[0]?.content?.parts?.[0]?.text;
            if (!jsonText) throw new Error("AI could not understand the document.");
            const resultObject = JSON.parse(jsonText.replace(/^```json\s*|```$/g, '').trim());
            if (!resultObject.data || !Array.isArray(resultObject.data) || resultObject.data.length === 0) throw new Error("AI analysis resulted in empty or invalid data.");
            appData = resultObject.data;
            const viewSuggestion = resultObject.viewSuggestion || 'table';
            source = 'uploaded';
            prepareAndRender(viewSuggestion);
        } catch (error) {
            console.error('AI Error:', error);
            showStatus(error.message, 'error');
        } finally {
             processingLoader.classList.add('hidden');
        }
    }

    function prepareAndRender(suggestedView) {
        controlsArea.classList.remove('hidden');
        downloadOptions.classList.remove('hidden');
        if (!appData || appData.length === 0) { dataContainer.innerHTML = `<p class="text-center text-slate-500 p-8">${getText('no_data')}</p>`; dataContainer.classList.remove('hidden'); return; }
        dataHeaders = Object.keys(appData[0]);
        dayColumnKey = findDayColumnKey(dataHeaders);
        dateColumnKey = findDateColumnKey(dataHeaders);
        document.querySelectorAll('#view-buttons button').forEach(btn => btn.classList.add('hidden'));
        ['view-card', 'view-table', 'view-list'].forEach(id => document.getElementById(id).classList.remove('hidden'));
        if (dateColumnKey) document.getElementById('view-calendar').classList.remove('hidden');
        switchView(suggestedView);
    }
    
    function renderCardView() { 
        dataContainer.innerHTML = '';
        const groupedData = appData.reduce((acc, item) => {
            const key = dayColumnKey ? (item[dayColumnKey] || 'Uncategorized') : 'All Entries';
            (acc[key] = acc[key] || []).push(item);
            return acc;
        }, {});
        const sortedGroups = dayColumnKey ? Object.keys(groupedData).sort((a,b) => getDayIndex(a) - getDayIndex(b)) : ['All Entries'];
        sortedGroups.forEach((groupKey, index) => {
            const dayClass = DAY_CLASSES[groupKey] || '';
            const daySection = document.createElement('div');
            daySection.className = `day-section ${dayClass} p-4 rounded-lg fade-in`;
            daySection.style.animationDelay = `${index * 0.05}s`;
            let htmlContent = `<h3 class="text-xl font-bold text-slate-900 dark:text-white mb-3">${groupKey}</h3><div class="space-y-4">`;
            groupedData[groupKey].forEach(entry => {
                let cardContent = '';
                dataHeaders.forEach((header, i) => {
                    const value = entry[header] || 'N/A';
                    const displayValue = `<span class="break-words">${value}</span>`;
                    if (i < 2) cardContent += `<p class="font-semibold text-slate-900 dark:text-white capitalize">${header}: ${displayValue}</p>`;
                    else cardContent += `<p class="text-slate-500 dark:text-slate-400 capitalize text-sm">${header}: ${displayValue}</p>`;
                });
                htmlContent += `<div class="class-card p-4 rounded-lg"><div class="flex flex-col gap-1">${cardContent}</div></div>`;
            });
            htmlContent += `</div>`;
            daySection.innerHTML = htmlContent;
            dataContainer.appendChild(daySection);
        });
        dataContainer.classList.remove('hidden');
    }

    function renderTableView() { 
        const thead = dataTable.querySelector('thead'); const tbody = dataTable.querySelector('tbody');
        thead.innerHTML = ''; tbody.innerHTML = '';
        const headerRow = document.createElement('tr');
        dataHeaders.forEach(header => { headerRow.innerHTML += `<th class="capitalize">${header}</th>`; });
        thead.appendChild(headerRow);
        appData.forEach(entry => {
            const row = document.createElement('tr');
            const dayValue = dayColumnKey ? entry[dayColumnKey] : null;
            row.className = `${DAY_CLASSES[dayValue] || ''} text-sm`;
            let rowHTML = '';
            dataHeaders.forEach(header => { rowHTML += `<td class="whitespace-nowrap">${entry[header] || 'N/A'}</td>`; });
            row.innerHTML = rowHTML;
            tbody.appendChild(row);
        });
        dataTable.parentElement.classList.remove('hidden');
    }
    
    function renderListView() { 
        dataContainer.innerHTML = '';
        let listHtml = '<ul class="space-y-3 p-4">';
        appData.forEach(item => {
            const primaryText = Object.values(item)[0] || '';
            const secondaryText = Object.values(item)[1] || '';
            listHtml += `<li class="flex items-center rounded-md bg-white dark:bg-slate-800 p-3 shadow-sm border dark:border-slate-700"><input type="checkbox" class="h-5 w-5 rounded border-gray-300 text-blue-600 mr-4 focus:ring-blue-500"><div><p class="font-medium text-slate-800 dark:text-slate-200">${primaryText}</p>${secondaryText ? `<p class="text-sm text-slate-500 dark:text-slate-400">${secondaryText}</p>` : ''}</div></li>`;
        });
        listHtml += '</ul>';
        dataContainer.innerHTML = listHtml;
        dataContainer.classList.remove('hidden');
    }
    
    function renderCalendarView() { 
        calendarContainer.innerHTML = '';
        const now = new Date();
        const year = now.getFullYear(); const month = now.getMonth();
        const firstDay = new Date(year, month, 1);
        const lastDay = new Date(year, month + 1, 0);
        const daysOfWeek = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
        daysOfWeek.forEach(day => calendarContainer.innerHTML += `<div class="calendar-header">${day}</div>`);
        for (let i = 0; i < firstDay.getDay(); i++) calendarContainer.innerHTML += `<div class="calendar-day other-month"></div>`;
        for (let day = 1; day <= lastDay.getDate(); day++) {
            let dayCell = `<div class="calendar-day"><div class="calendar-day-number">${day}</div>`;
            const currentDate = new Date(year, month, day);
            appData.forEach(item => {
                if(item[dateColumnKey]) {
                    const itemDate = new Date(item[dateColumnKey] + 'T00:00:00');
                    if (itemDate.toDateString() === currentDate.toDateString()) {
                        const primaryText = Object.values(item)[0] || 'Event';
                        dayCell += `<div class="calendar-item" title="${primaryText}">${primaryText}</div>`;
                    }
                }
            });
            dayCell += `</div>`;
            calendarContainer.innerHTML += dayCell;
        }
        calendarContainer.classList.remove('hidden');
    }

    function switchView(view) {
        currentView = view;
        document.querySelectorAll('#view-buttons button').forEach(btn => {
            btn.classList.remove('bg-blue-600', 'text-white');
            btn.classList.add('text-slate-600', 'dark:text-slate-300');
        });
        const activeBtn = document.getElementById(`view-${view}`);
        if(activeBtn) {
            activeBtn.classList.add('bg-blue-600', 'text-white');
            activeBtn.classList.remove('text-slate-600', 'dark:text-slate-300');
        }
        [dataContainer, dataTable.parentElement, calendarContainer].forEach(el => el.classList.add('hidden'));
        if (view === 'card') renderCardView();
        else if (view === 'table') renderTableView();
        else if (view === 'list') renderListView();
        else if (view === 'calendar') renderCalendarView();
        else renderTableView();
    }

    function createCaptureStylesheet(isDark) { /* ... unchanged ... */ }
    
    function getActiveElementForCapture() {
        switch (currentView) {
            case 'card': case 'list': return dataContainer;
            case 'table': return dataTable.parentElement;
            case 'calendar': return calendarContainer;
            default: return null;
        }
    }

    async function captureFullElement(element) { /* ... unchanged ... */ }
    async function downloadAsPDF() {
        const { jsPDF } = window.jspdf; const element = getActiveElementForCapture(); if (!element) return;
        showStatus('preparing_pdf', 'success');
        try { const canvas = await captureFullElement(element); const imgData = canvas.toDataURL('image/png'); const { width, height } = canvas; const pdf = new jsPDF({ orientation: width > height ? 'l' : 'p', unit: 'px', format: [width, height] }); pdf.addImage(imgData, 'PNG', 0, 0, width, height); pdf.save('time-space-export.pdf'); } catch (error) { showStatus(error.message, 'error'); }
    }
    async function downloadAsPNG() {
        const element = getActiveElementForCapture(); if (!element) return;
        showStatus('preparing_png', 'success');
        try { const canvas = await captureFullElement(element); const link = document.createElement('a'); link.download = 'time-space-export.png'; link.href = canvas.toDataURL('image/png'); link.click(); } catch (error) { showStatus(error.message, 'error'); }
    }
    function downloadAsCSV() {
        const csv = Papa.unparse(appData); const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' }); const link = document.createElement('a'); link.href = URL.createObjectURL(blob); link.download = 'time-space-export.csv'; link.click();
    }
    function downloadAsXLSX() {
        const ws = XLSX.utils.json_to_sheet(appData); const wb = XLSX.utils.book_new(); XLSX.utils.book_append_sheet(wb, ws, 'Data'); XLSX.writeFile(wb, 'time-space-export.xlsx');
    }
</script>

</body>
</html>

